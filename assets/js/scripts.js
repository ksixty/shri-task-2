"use strict";var SCHEDULE_LINK="https://vanyaklimenko.ru/schedule.json",SCHEDULE_DOM=document.querySelector("#schedule"),redux={general:{schools:{},lecturers:{}},schedule:{}},fetchSchedule=function(){return new Promise(function(e,t){fetch(SCHEDULE_LINK).then(function(e){return e.json()}).then(function(t){return e(t)})["catch"](function(e){return t(e)})})};fetchSchedule().then(function(e){var t=e.schedule,n=e.general;console.log(e),redux.general.schools=n.schools,redux.general.lecturers=n.lecturers,redux.schedule=t,renderLectures()});var getMonth=function(e){if(!e)return!1;var t=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь"];return e=new Date(e),t[e.getMonth()]||!1},getDayOfTheWeek=function(e){if(!e)return!1;var t=["пн","вт","ср","чт","пт","сб","вс"],n=new Date(e).getDay();if(n>4);return t[n]},filterLectures=function(e,t){return e},renderLectures=function(e){var t=redux.schedule;if(!t)return!1;for(var n={},r=0;r<12;r++)n[r]=[];var i=[];for(var o in t){var c=t[o];i.push(c)}i.forEach(function(e){var t=e.date,r=(e.school,new Date(t).getMonth()),i=renderLecture(e),o=n[r];o.push(i),n[r]=o});for(var a in n){var l=n[a];if(l.length>0){var u=document.createElement("div");u.innerHTML='\n                <div class="schedule__month month month--expanded">\n                    <div class="schedule__title">'+getMonth(a)+"</div>\n                    "+l.join("")+"\n                </div>\n             ",SCHEDULE_DOM.appendChild(u)}}},getLecturer=function(e){var t=redux.general.lecturers,n=t[e];return{name:n.name,company:n.company||"Яндекс",bio:n.bio}},getSchool=function(e){var t=redux.general.schools;return e?t[e]:t.all},renderLecture=function(e){var t=e.school,n=e.name,r=e.lecturer,i=e.pic,o=e.date,c=e.venue,a=getLecturer(r),l='\n        <div class="schedule__event event">\n            <div class="event__header event__header--'+(t||"all")+'">\n                <div class="event__school">'+getSchool(t)+'</div>\n            </div>\n            <img class="event__pic" src="'+i+'">\n            <div class="event__title">\n                <div class="event__date">\n                    <div class="event__date-number">'+new Date(o).getDate()+'</div>\n                    <div class="event__date-week">'+getDayOfTheWeek(o)+'</div>\n                </div>\n                <div class="event__text">\n                    <div class="event__name">'+n+'</div>\n                    <div class="event__meta meta">\n                        <div class="meta__item meta__item--lecturer">'+a.name+'</div>\n                        <div class="meta__item meta__item--company">'+a.company+'</div>\n                        <div class="meta__item meta__item--place">'+c+"</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ";return l};!function(e,t,n){t[e]=n()}("mobControls",void 0,function(){function e(){return window===this?new e:(this.deserialized=!1,this)}var t="https://vanyaklimenko.ru/schedule.json",n={general:{schools:{},lecturers:{},venue:{}},schedule:{}},r=function(){return new Promise(function(e,n){fetch(t).then(function(e){return e.json()}).then(function(t){return e(t)})["catch"](function(e){return n(e)})})},i=function(e){n.general.schools=e.general.schools,n.general.lecturers=e.general.lecturers,n.general.venue=e.general.velue};return e.prototype.serialize=function(e){var t=localStorage.getItem("mobilization");console.log(t)},e.prototype.deserialize=function(){return new Promise(function(e,t){var n=localStorage.getItem("mobilization");return n?(n=JSON.parse(n),i(n),(void 0).deserialized=!0,e(n)):void r().then(function(t){return localStorage.setItem("mobilization",JSON.stringify(t)),i(t),(void 0).deserialized=!0,e(t)})["catch"](function(e){return t()})})},e.prototype.getData=function(){if(!(void 0).deserialized)throw new Error("You can't use (getData) method until \n          the library is not deserialized");return n},e.prototype.venue={get:function(){return n.general.venue},edit:function(e){return this},remove:function(e){return this},add:function(e){e.name}},e.prototype.schools={get:function(){return n.general.schools},edit:function(e){return this},remove:function(e){return this},add:function(e){}},e.prototype.lecturers={get:function(){return n.general.lecturers},edit:function(e){return this},remove:function(e){return this},add:function(e){e.name,e.time}},e});var SCHEDULE_LINK="https://vanyaklimenko.ru/schedule.json",SCHEDULE_DOM=document.querySelector("#schedule"),redux={general:{schools:{},lecturers:{}},schedule:{}},fetchSchedule=function(){return new Promise(function(e,t){fetch(SCHEDULE_LINK).then(function(e){return e.json()}).then(function(t){return e(t)})["catch"](function(e){return t(e)})})};fetchSchedule().then(function(e){var t=e.schedule,n=e.general;console.log(e),redux.general.schools=n.schools,redux.general.lecturers=n.lecturers,redux.schedule=t,renderLectures()});var getMonth=function(e){if(!e)return!1;var t=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь"];return e=new Date(e),t[e.getMonth()]||!1},getDayOfTheWeek=function(e){if(!e)return!1;var t=["пн","вт","ср","чт","пт","сб","вс"],n=new Date(e).getDay();return t[n]},filterLectures=function(e,t){return e},renderLectures=function(e){var t=redux.schedule;if(!t)return!1;for(var n={},r=0;r<12;r++)n[r]=[];var i=[];for(var o in t){var c=t[o];i.push(c)}i.forEach(function(e){var t=e.date,r=(e.school,new Date(t).getMonth()),i=renderLecture(e),o=n[r];o.push(i),n[r]=o});for(var a in n){var l=n[a];if(l.length>0){var u=document.createElement("div");u.innerHTML='\n                <div class="schedule__month month month--expanded">\n                    <div class="schedule__title">'+getMonth(a)+"</div>\n                    "+l.join("")+"\n                </div>\n             ",SCHEDULE_DOM.appendChild(u)}}},getLecturer=function(e){var t=redux.general.lecturers,n=t[e];return{name:n.name,company:n.company||"Яндекс",bio:n.bio}},getSchool=function(e){var t=redux.general.schools;return e?t[e]:t.all},renderLecture=function(e){var t=e.school,n=e.name,r=e.lecturer,i=e.pic,o=e.date,c=e.venue,a=getLecturer(r),l='\n        <div class="schedule__event event">\n            <div class="event__header event__header--'+(t||"all")+'">\n                <div class="event__school">'+getSchool(t)+'</div>\n            </div>\n            <img class="event__pic" src="'+i+'">\n            <div class="event__title">\n                <div class="event__date">\n                    <div class="event__date-number">'+new Date(o).getDate()+'</div>\n                    <div class="event__date-week">'+getDayOfTheWeek(o)+'</div>\n                </div>\n                <div class="event__text">\n                    <div class="event__name">'+n+'</div>\n                    <div class="event__meta meta">\n                        <div class="meta__item meta__item--lecturer">'+a.name+'</div>\n                        <div class="meta__item meta__item--company">'+a.company+'</div>\n                        <div class="meta__item meta__item--place">'+c+"</div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ";return l},api=mobControls();api.deserialize().then(function(){Vue.component("lecturers",{data:function(){return{lecturers:api.lecturers.get()}},template:'\n\t\t\t<select class="entry__field entry__field--lecturer">\n\t\t\t\t<option v-for="lecturer of lecturers">{{lecturer.name}}</option>\n\t\t\t</select>\n\t\t'}),Vue.component("venues",{data:function(){return console.log(api.venues.get()),{venues:api.venues.get()}},template:'\n\t\t\t<select class="entry__field entry__field--venue">\n\t\t\t\t<option>{{venue.}}</option>\n\t\t\t</select>\n\t\t'});new Vue({el:"#lectures",data:function(){return{lecturers:api.lecturers.get(),schools:api.schools.get()}},template:"\n\t\t\t<div>\n\t\t\t\t<lecturers></lecturers>\n\t\t\t</div>\n\t\t",methods:{toggle:function(e){console.log(e),console.log("focus")}}}),new Vue({template:'\n\t\t\t<form class="editor__entry entry">\n\t\t\t\t<input class="entry__field entry__field--name" placeholder="Название"\n\t\t\t\t\t@focus=\'toggle(e)\'\n\t\t\t\t\t@blur=\'toggle(e)\'\n\t\t\t\t>\n\t\t\t\t<input class="entry__field entry__field--pic" placeholder="Ссылка на картинку">\n\t\t\t\t<select class="entry__field entry__field--lecturer">\n\t\t\t\t\t<option>Сергей Душкин</option>\n\t\t\t\t</select>\n\t\t\t\t<select class="entry__field entry__field--venue">\n\t\t\t\t\t<option>Синий кит, 4 этаж</option>\n\t\t\t\t</select>\n\t\t\t\t<input class="entry__field entry__field--date" type="date" name="" placeholder="0">\n\t\t\t\t<input class="entry__field entry__field--time" type="time" name="" placeholder="0">\n\t\t\t\t<button class="entry__submit-button">Сохранить</button>\n\t\t\t</form>\n\t\t'})});